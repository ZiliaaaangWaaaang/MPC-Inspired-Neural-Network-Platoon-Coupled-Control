function [Y,Xf,Af] = nnmove_21(X,~,~)
%NNMOVE_21 neural network simulation function.
%
% Auto-generated by MATLAB, 27-Dec-2024 16:17:24.
% 
% [Y] = nnmove_21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3 4 6 7 8 9 10];
x1_step2.xoffset = [-1;-1;-0.881804843746703;-1;-1;-1;-1;-1;-0.976718263115482];
x1_step2.gain = [1;1;1.06280946541617;1;1;1;1;1;1.0117779742915];
x1_step2.ymin = -1;

% Layer 1
b1 = [-2.0192090287623587486;-1.6542533689850626999;-1.8309265471035671702;-1.3258878929670687707;0.79704299540194778473;-0.85263885607942691003;-0.8025416829252230988;-0.85392281395385782883;0.066148618247643634072;-0.16882521974976733015;-0.055423091665432334951;-0.3092631791841737865;0.32407321830757440662;0.2517378079808259006;0.86538460062333677492;-0.310497828683634014;1.3548778778180967652;1.2575597183268032442;1.4882967448724087056;-1.9095053446039524925];
IW1_1 = [-0.030021095726462290743 -0.74308467147040790923 0.17928708355439057498 1.0920236044228941452 0.24239659588254997002 1.0804145781870948539 1.3178950672643499065 -0.37304821665354809257 0.11992056988081090108;0.92859029510210899794 -0.42260288127551443038 -0.50919495634145672813 -0.37655095866655202697 -0.82816831627641240843 -0.59137798108214001402 -0.45248885598266458397 0.10293619408585397146 -0.9001311153331233994;0.57691877039096783886 -0.036800348163166171633 0.68879744366820705448 -0.77032437026404931846 -0.52887605051924080346 0.52620034902634948981 -0.7150193472885230106 0.69513753571961212074 -0.80556322402717517317;1.1339180513733588818 0.50280210237729061618 0.72433405795367211688 0.34614312677564113008 0.91601253880190669499 0.1786687537223564104 0.28816848258469879296 0.066016258846920083947 -0.67904689243363192119;-1.142108923375362739 0.69895254517623317536 0.93965191115759683083 0.91322316390343805104 -0.78886849839839567888 0.19316923971040986241 0.63629187026256095461 -0.43117492744542101901 -0.35870687495467623584;0.23252605585960481327 -0.40003362693575011955 -0.15988831684135546007 0.48579398749912577893 1.3869515112179338079 -0.096179441080685434962 -0.56525742656177313528 1.0016054448201017202 -0.39918487639944688627;0.37607729362740754953 0.40693127687949948168 -1.2029862320083042349 0.35392906955097275246 -0.50430506963261201303 -0.24444254822108069103 -0.44859125878695921275 0.70207373301423681156 -0.93551713503533673322;1.5124431621361729139 -0.26108877143335035287 0.6346891802466307908 0.29569992414971657535 0.89247544442807336118 0.47570775932597858526 0.04422485674507817266 0.269162086700694414 0.1464798378095381326;0.95862947119633534765 0.058786460625982223105 0.62505448077605252344 -0.022288677479170668216 -0.4185469425020780232 1.0955544036108371131 0.96867790062332881362 -0.50676490453972289352 -0.7587951758261480828;-0.37371449446417459583 -0.24889496658182161393 0.64638608167519473469 0.056659820937066229796 1.2650909908895306977 -0.45320518685219696176 0.12955727658992241547 -0.35231958807899599329 -0.99556864223550900483;0.35083757375465057793 -0.4744835041396213704 -0.87417359551170081833 -1.3007942036754391868 0.2840833835684967168 0.46988891000003107923 1.2623586254927243733 0.10577014723889111014 0.6027637575420305982;1.5904002585693330918 -0.62518082516950623795 0.73476980175674955209 -0.52794923284631078975 -0.060323342592304540766 0.53416493334863612841 -0.60176825042348047745 -0.11446574206699974829 -0.26321452427075037184;0.14277847484235289821 1.2106365542740542551 -0.73374034955980127481 -0.37690772607272332584 0.6182475474915898328 0.18371836248302964023 -0.43865929187948726753 1.0669817886425547737 0.47863928902559543799;0.62469253033266769481 -1.0157240094387423035 -0.10124189612370700087 0.0959426717957245212 1.0421660447067571109 -0.067293122703707408672 0.18709674939236650704 -0.38686544432707431485 0.48692207326171016435;1.0169569836262075668 -0.2947234064101647566 0.067510300689114274841 -0.90455116260681478479 -0.026366244839087844831 -0.19295626057623260774 -0.7712851132723437253 -0.78358738997818955241 -0.54534847034719358128;-1.0568861836734979587 0.40704768315804468193 1.493694675099795699 0.62507887150471908022 -1.1466985509236340413 0.59762954039167404119 -0.83920700575828210965 -0.21661442843837358518 -0.47937040066192343479;0.54034725978973041638 -0.53798256711349645709 0.14617774791206866736 0.017396838814026621689 0.080052636541297891859 0.5248806908577009489 -1.1341992895758825632 1.4564548035295674655 0.78883717993785529288;0.25774384730114863196 -0.21109569176658171674 -1.3920748631105595017 -0.85413200896697782927 -0.71275456501201905901 -0.8832822330256910881 0.29287124355109384055 -0.75155189057131810415 0.19479910656928520196;0.19460043845431698739 1.0642502516681082714 -0.1654680009586644851 0.82593320062682817895 -0.32453942116069023349 -1.0277042781394569726 -0.60403675838638026807 0.44453823100744049857 0.78076429861146345868;-0.40163930219668575461 -0.60241031265105327019 0.00050391562788794364014 -0.83652843879331229004 0.43047390698625853656 -1.2185710461903622726 -0.70411592177255488689 -0.84445934662908994639 -0.74823078903648887472];

% Layer 2
b2 = [-1.5341547668874200294;-0.95259965658798573251;-1.0947586942824780731;-0.88654438741013896763;-0.19498903083209248588;-0.1440728204715092664;0.41907444901509405266;-0.56895149714740589353;-1.5260480754938758885;1.6167925325036014428];
LW2_1 = [0.0716242651629473287 0.30614012756775271784 0.35906168381632791453 -0.28548330821222794862 0.46909256318840514277 0.16300051183025351942 0.61231426941777566952 -0.343309337960756078 -0.20984566400720927604 0.5847658068795669184 -0.40313936192143123849 0.20027467523679709505 0.32209785889478353971 -0.51182346020802371722 0.30661318281761157367 -0.29250313380707382294 -0.17025524554331536442 -0.13141724265409235328 0.30136806215282424537 0.80199587649685577517;0.57497148981978851712 0.69679441816091891582 -1.1752565401691683622 -0.078586422204816125392 -0.70926251281817043193 0.76243883296799552785 -0.1829739216536879487 -0.0021379616239416733559 0.80130822834051118608 -0.50806571633043162706 0.18675585208466727316 0.28831522227254380297 0.034753189215861395034 0.60595377828017316091 0.15631232871831898801 -0.78602472835381942406 -0.2956285033585159816 -0.39912309992239247691 0.21527183053597592766 -0.19226070839101644383;0.045194182601869900551 -0.075134759890302105223 0.64004614093829381716 0.18570196326734728087 -0.0054276481148387289988 -0.14458167880958106011 0.09244075975018595237 -0.3601305407835179162 0.4889018698445941058 -0.18868572075155187751 -0.4145596662421286438 0.4583531258547291487 0.04247672453009883331 -0.28996379160563551247 0.25843159183233854748 -0.032229254271898891138 0.03850479016997849363 0.17699090834906799907 -0.14538474279370036668 -0.00379587029042692016;0.54470962820716894992 -0.19316214915087395743 0.27159195218578402464 -0.34691203505875445323 -0.011447291863833808367 -0.073989502757407371591 -0.081927425510217866123 0.24961060023593595325 0.11017393328389760154 -0.67193154353328321537 -0.52705749231908582964 -0.27995166678707716912 0.010674557011058048023 -0.12191651932033775729 0.86048400902639754495 -0.17197639177731971483 0.39815911491005628875 0.18754688119908363708 0.049219822484098077475 0.24063383998124684982;0.039028056444136649539 0.074705759386461415006 -0.46435668680608788161 -0.93150410959700669089 0.027469067565400497044 0.021075259203423877402 -0.432470934399334761 0.01977288655368920206 -0.084495338872250899676 -0.061669007268523930165 0.43753751119468947683 0.50874140199596673551 -0.12990637101509233675 -0.066914747515676387124 -0.14640041170550940897 0.50110399682799489085 -0.63396104752436877039 0.32349349784239372907 0.64243898389109221903 0.38658942956753417075;-0.24029783750190791825 -0.15121084835169432137 -0.14502975068632814604 0.2088261014754181355 -0.41459954207126847869 0.55081400040121941686 0.21921237356972228527 -0.59185138046504714993 0.0046935947226380558828 -0.021544722411246344795 0.16351783157769567145 0.6079437693868708914 -0.73411138444677648263 -0.46220841451506405884 -0.52124711819846791805 0.48087128387383137884 -0.0019550522535584369255 -0.39861105401643620594 0.097314540505296309725 -0.12303451939849312236;0.75159140945171054593 -0.29077457536810513705 0.09988657419820355654 -0.087636408125245243705 -0.33775134040080889708 -0.81274391993679540036 0.12947384317099444595 -0.75667429680793885094 0.52897090695084092449 0.24524389076023461742 0.20015301714350824946 0.22171342268327243197 0.30572754226938403388 -0.45953711143403563888 0.31166750157610811911 -0.4652488004227676166 0.43942583159059828146 -0.027514772494209818743 -0.19144594551726853981 0.58694003854283549604;-0.18356733157279986335 -0.02801187160119437275 -0.34545788847750058537 0.73961314914901343798 -0.68723328406818595671 0.14304205179760967614 0.4356680741278021185 1.255281542146302165 0.217148490374387243 0.32587581544198579442 0.12785141969090310643 0.40199927040859967375 -0.22928919049646445671 1.069070328315924634 -0.14672940879955587157 -1.1012626467400075114 0.72131223379865394563 0.87641133471976817582 -0.015619357225292902769 0.72429444070206427941;-0.20486345713896766951 0.18234048824902493458 0.039598935920661403054 0.082081641302304053642 -0.17117662886749557272 0.27354553470611459032 -0.43414442826165439149 0.20187757495181224421 0.14892142649718836944 -0.21902653037619970733 -0.066479701848668165676 -0.59188177480278303388 -0.33823761444053285219 -0.40424272132892291598 -0.18298064841887770604 -0.29617842111767872515 0.54675730363265195866 0.12400176262499941482 0.6076300562311205411 -0.34954323086379196495;0.31521382624856614241 0.65075594046797069492 -0.44723290893991557438 0.50306817722810626137 0.24414050790974306526 0.14533350836877390044 0.25157158074282814919 -0.11701601019205519483 -0.18280360285221466943 -0.19488844631924007178 0.0031063017593495681479 -0.60231697827356689423 -0.21150902881155730917 -0.022719603102959388952 0.10450471758200510775 -0.40695596500118191852 0.16709953461627155558 0.58441298358799720347 0.26653037816537805682 0.31074711355968182014];

% Layer 3
b3 = [-1.9914159804548563493;-1.7199516827678762443;1.4980329347588132727;-1.2418444936835382197;-1.1196850551680528341;-0.93288821102371422;0.58607738901738215542;0.66793688091735003987;0.32844144755288362525;-0.062709174840382547744;0.35522638418516450098;0.30510681726488597665;-0.66856872168375092169;-0.78636815530939507823;1.0280262507873993982;1.1266130763312882657;1.341574714090465692;-1.5991740183504887796;-1.6463325668325166085;-1.8740049604023691909];
LW3_2 = [1.0925365537715123754 -0.25359464506659507022 0.11707267420720740558 -1.0595425882660072237 -0.74151325523480171586 -0.30500866960706279896 -0.039649339215063306163 0.063570354688501584661 -0.24694738684132644391 -0.66866904881431477037;0.67518342313065404792 0.81223797659350993605 0.47771558939167924063 -0.64209469680913133782 0.6341249331681456658 -0.35914005579991836736 0.60730393938778637342 -0.21779364700176323533 -0.72109578822485054239 0.15413136131227206382;-0.37415110761574138509 0.44701643086467091059 0.26038202425989498412 0.09886734708458570775 0.46915929752530488583 -1.1443948809738084815 -0.49618016443430174034 0.72066699620933871717 0.53554163254772024771 0.21172784686302492663;0.18894963801247224855 -0.68593536305007207776 0.15270182591776643166 0.16010353738015636882 -0.97165596361201089781 0.61568243611112782876 0.45254478627308758476 0.84340121921511823633 0.66323868526605411766 -0.48381378080295484034;0.51991280294468011913 -0.07812390662574267286 -0.91038681232527729481 0.24103242627921386831 -0.14011823959124691807 -0.71897119966863909379 0.76678722575150870533 -0.9556250115285667146 0.94949246491261929393 0.75403559056408886452;0.96942868799800341328 -0.084697680248724718788 -0.57480751463494594855 0.77980033200317655506 0.31820713682907486586 0.56493386171909676374 -0.41457419949781970647 -0.99742016831508639729 0.35486300588977465198 0.21169279524449499674;-0.22192423629066951318 0.17982338123713365041 0.63717083543156782799 -0.30582769461860048743 0.64840430878399346604 0.19889366327727955874 -0.98231463794532336564 0.29122185283451695881 -0.53080310153516019334 0.68177612430332656945;-0.82261970682095852947 -1.0809725821197575524 0.41503246665624193845 0.78047369404670696724 0.45609407520097122735 0.57162229933245389812 -0.88728490510309465655 0.024032682198097940485 -0.46242649590305273666 -0.51331189352104833468;-0.1892784400157024316 -0.85437793074100942814 -0.088080228050328238099 -1.0222505907944867687 0.40553962087719225282 0.085303349499357777885 -0.80566624178744683515 -0.5526097869248987049 -0.33908092770961895113 0.86843848518512878343;0.61943923465368233572 0.041201509385268904329 0.365342765607450215 0.041842004530576279442 0.75786249417371687187 -0.51262047165837698603 -0.68527987304218784814 -0.37973851847333112142 0.68237941338089802557 -0.74498281731687199247;-0.086581171712578702815 -0.86264480123613695994 -0.47710298703103370954 -0.73192053000817403063 0.35854158572748134892 0.032776289456189267035 -0.79595264052271730293 -0.5896442877128299509 -0.71358348486057232574 0.80081700923957910287;0.56674892292916512204 -0.69335951883066093693 -0.68996112695518474478 0.86812171046359798421 0.013926298226398368951 -0.38348756835738423421 -0.40330022463783521403 0.65152588104888842224 -0.15344247862756490997 0.64627475954855406748;-0.60815243307431221531 0.86923412071178007832 -0.26369374331647998932 0.54774487203152977255 -0.85596513396645301786 0.20097719840760658316 0.15366265645913312898 0.84557971046105262491 -0.16313571367851928406 -0.65735898442602436198;-0.2120311939150035796 -0.47007339245816920359 0.76595938738121460698 0.91407576604728124625 -0.056295788036178795455 -0.52546706875134474579 0.75142218368787283556 -0.73874423388821963687 0.77903627803621799952 -0.84876628024118172533;0.62812982318190402342 -0.55595555924350614774 1.1881512812016412628 -0.065974235667305841657 0.82941164515183229966 0.36609116408075553784 0.16914194810657312562 0.42224043291561452751 -0.40383573274329986891 0.53313128070435333861;0.26753155991385318968 -0.26302196076516232148 0.32809468378916228914 1.0078269268823421001 -0.61193889297252179738 -0.94278513732857116558 -0.68116717257368220029 -0.56578389544001261857 0.13378547447165278772 0.84032507321222071894;0.58042738310962482817 0.081801491175637314202 -0.87085958279900466117 0.63269852501736922878 0.059584703291238778899 1.1340328895148004129 -0.70382188373112852808 -0.022057388305891753588 0.17827897137323875376 0.20266655841996120135;-0.20824739589281515695 -0.82776517992048370687 0.215384855664724012 -0.78290159602715536646 0.17501936701490450332 -0.22941216125165281303 -0.90050573646205667178 -0.20055723787713680695 0.44427636464347264322 -1.0813754098863641584;-0.29634829133103934851 0.58237497790237768847 0.4441227880746048684 -0.97162937704440266451 -0.33167639792457714876 -0.45744249422110438985 0.80598132016538193145 -0.88391401622049847742 0.75680309746270768567 0.1233567710381250071;-1.0721305154601674658 -0.74230885613130603851 0.15544926383679300019 -0.62236102534308412881 -0.16804925832550837717 0.076023236389220288922 0.065945372046116890186 -0.12117876052233150785 0.38877465579006398322 1.0316136355618565901];

% Layer 4
b4 = [0.49809834875145708732;0.38875958949083860849];
LW4_3 = [-0.95881330468345415952 -0.82215313630555209023 -0.45010161295718886798 0.49564616359981139571 0.89110821944132712069 -0.58493103002011082037 -0.32448410968381669051 0.24404871692284241247 -0.45767948870681246509 0.33105043732028061054 0.40942859666276054664 -0.93038167409876548763 0.25859125906976165865 -0.54026985311805275636 0.43420067455033323212 -0.70077676043113312776 0.48065285393540796433 0.52644058222420397897 0.69693028288361624778 0.069068657585139678345;0.80908500042896658311 -0.36387091189437636984 -0.29024670492917481468 0.36891932837525631683 -0.23077752310945154335 0.60478702468082601307 -0.22408829087826967474 0.91118529650064139513 1.0130283282025986935 0.13205810448795507472 0.69268346616534726135 0.25573547436316224069 0.66781192671784561643 -0.38522384666742709447 -0.39599046202456839039 -0.050429366466118480394 -0.43115813163876293146 -0.26161457199733645362 0.28448811680809960034 -0.49746967854489571037];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1];
y1_step1.xoffset = [-1;-1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
